<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="cuba-data-loading-behavior.html">

<!--
The `cuba-service` element provides an ability to load data from [middleware service](https://doc.cuba-platform.com/manual-latest/services.html).
The service should be [exposed](https://doc.cuba-platform.com/manual-latest/rest_api_v2_services_config.html) in REST API.
-->

<dom-module id="cuba-service">
  <template>
    <style>
      :host {
        display: none;
      }
    </style>
  </template>

  <script>
    Polymer({

      is: 'cuba-service',

      behaviors: [CubaDataLoadingBehavior],

      properties: {
        serviceName: String,
        method: String,
        params: {
          type: Object
        },
        handleAs: {
          type: String,
          value: 'json'
        }
      },

      observers: ['_optionsChanged(serviceName, method, handleAs, params.*, auto)'],

      _load: function() {
        var ajaxSettings = {
          dataType: this.handleAs
        };
        return cubaApp.invokeService(this.serviceName, this.method, this.params, ajaxSettings);
      }
    });
  </script>
</dom-module>
